<section hlmCard
  class="group relative flex h-full flex-col overflow-hidden border-border/40 bg-card/50 backdrop-blur-sm shadow-sm hover:shadow-xl hover:border-primary/40 hover:-translate-y-1 active:scale-[0.98] card-hover-effect"
  [class.shadow-[0_0_30px_rgba(245,158,11,0.15)]]="company().priority === 'Tier1'"
  [class.border-amber-500/20]="company().priority === 'Tier1'" (click)="onViewDossier()">

  <!-- Decorative Accent Line -->
  <div class="absolute top-0 left-0 w-full h-1 transition-transform origin-left"
    [class.bg-gradient-to-r]="company().priority === 'Tier1'" [class.from-amber-400]="company().priority === 'Tier1'"
    [class.via-amber-100]="company().priority === 'Tier1'" [class.to-amber-400]="company().priority === 'Tier1'"
    [class.bg-gradient-to-r]="company().priority !== 'Tier1'" [class.from-primary/0]="company().priority !== 'Tier1'"
    [class.via-primary/40]="company().priority !== 'Tier1'" [class.to-primary/0]="company().priority !== 'Tier1'"
    [class.scale-x-0]="company().priority !== 'Tier1'" [class.group-hover:scale-x-100]="company().priority !== 'Tier1'">
  </div>

  <!-- Priority Indicator (Top Right) -->
  <div class="absolute top-4 right-4 z-10">
    @if (company().priority === 'Tier1') {
    <div
      class="flex items-center justify-center h-8 w-8 rounded-full bg-amber-500/10 shadow-[0_0_15px_rgba(245,158,11,0.3)] animate-pulse-soft border border-amber-500/20 group-hover:scale-110">
      <ng-icon name="lucideCrown" class="text-amber-500 text-lg"></ng-icon>
    </div>
    } @else if (company().priority === 'Tier2') {
    <div
      class="flex items-center justify-center h-8 w-8 rounded-full bg-indigo-500/10 border border-indigo-500/20 group-hover:scale-110 shadow-[0_0_10px_rgba(99,102,241,0.1)]">
      <ng-icon name="lucideCircle" class="text-indigo-500 text-[8px]"></ng-icon>
    </div>
    } @else {
    <!-- Tier 3 Indicator (Subtle for "clean" look but visible in corner) -->
    <div
      class="flex items-center justify-center h-8 w-8 rounded-full bg-muted/20 border border-border/40 opacity-40 group-hover:opacity-100 group-hover:scale-110">
      <span class="text-[8px] font-black text-muted-foreground uppercase">T3</span>
    </div>
    }
  </div>

  <!-- Header: Logo/Icon + Industry -->
  <div hlmCardHeader class="flex-row items-start justify-between space-y-0 pb-4 pr-12">
    <!-- Icon Container -->
    <div
      class="h-12 w-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 shadow-sm"
      [class.bg-amber-500/10]="company().priority === 'Tier1'" [class.text-amber-500]="company().priority === 'Tier1'"
      [class.shadow-amber-500/20]="company().priority === 'Tier1'">
      <ng-icon name="lucideBuilding2" class="text-2xl"></ng-icon>
    </div>

    <!-- Industry Badge -->
    @if (company().industry) {
    <span hlmBadge variant="secondary"
      class="bg-muted/50 text-[10px] font-black uppercase tracking-[0.2em] border-none px-3">
      {{ company().industry }}
    </span>
    }
  </div>

  <!-- Content: Company Details & Skill Cloud -->
  <div hlmCardContent class="pt-2 flex-1 space-y-6">
    <div>
      <h3 hlmCardTitle class="text-xl font-black tracking-tighter mb-1 group-hover:text-primary leading-none"
        [class.text-amber-600]="company().priority === 'Tier1'"
        [class.dark:text-amber-500]="company().priority === 'Tier1'">
        {{ company().name }}
      </h3>

      @if (company().address) {
      <p
        class="flex items-center gap-1.5 text-[10px] font-bold text-muted-foreground uppercase tracking-widest leading-none">
        <ng-icon name="lucideMapPin" class="text-xs"></ng-icon>
        <span class="truncate">{{ company().address }}</span>
      </p>
      }
    </div>

    <!-- Skill Cloud: Tech Stack -->
    <div class="flex flex-wrap gap-2">
      @for (tech of getVisibleTechStack(); track tech) {
      <span
        class="skill-tag inline-flex items-center justify-center rounded-xl bg-muted/40 px-3 py-1.5 text-[10px] font-bold text-muted-foreground uppercase tracking-wider border border-transparent hover:bg-primary/10 hover:text-primary hover:border-primary/20 transition-all cursor-default">
        {{ tech }}
      </span>
      }
      @if (getRemainingTechCount() > 0) {
      <span
        class="inline-flex items-center justify-center rounded-xl bg-muted/20 px-3 py-1.5 text-[10px] font-bold text-muted-foreground/60 border border-dashed border-border/60">
        +{{ getRemainingTechCount() }}
      </span>
      }
    </div>
  </div>

  <!-- Footer: Pipeline & View Dashboard -->
  <div hlmCardFooter
    class="flex flex-col gap-4 border-t border-border/30 bg-muted/5 p-6 mt-auto transition-colors group-hover:bg-muted/10">
    <!-- Active Pipeline Indicator -->
    <div class="w-full space-y-3">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          @if (hasApplications()) {
          <div class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
          </div>
          <span class="text-[10px] font-black uppercase tracking-[0.15em] text-emerald-600 dark:text-emerald-400">
            {{ company().totalApplications }} Active Leads
          </span>
          } @else {
          <div class="h-2 w-2 rounded-full bg-muted-foreground/30"></div>
          <span class="text-[10px] font-black uppercase tracking-[0.15em] text-muted-foreground/60 px-1">
            Dormant Registry
          </span>
          }
        </div>

        <div class="flex items-center gap-1 group/btn cursor-pointer py-1"
          (click)="onViewDossier(); $event.stopPropagation()">
          <span
            class="text-[10px] font-black uppercase tracking-widest text-muted-foreground group-hover/btn:text-primary transition-colors">Dossier</span>
          <ng-icon name="lucideChevronRight"
            class="text-[10px] text-muted-foreground group-hover/btn:translate-x-1 transition-transform"></ng-icon>
        </div>
      </div>

      <!-- 4-Segment Modern Pipeline Bar -->
      <div class="grid grid-cols-4 gap-1.5 h-1.5">
        @for (seg of [1,2,3,4]; track seg) {
        <div class="pipeline-segment rounded-full" [class.bg-emerald-500]="getPipelineProgress() >= seg"
          [class.shadow-[0_0_8px_rgba(16,185,129,0.4)]]="getPipelineProgress() >= seg"
          [class.bg-muted/40]="getPipelineProgress() < seg" [class.animate-pulse-soft]="getPipelineProgress() === seg">
        </div>
        }
      </div>
    </div>
  </div>
</section>