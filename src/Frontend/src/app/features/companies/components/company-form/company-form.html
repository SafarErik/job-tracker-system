<div class="form-container">
  <!-- Loading State -->
  @if (isLoading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p>Loading company data...</p>
  </div>
  }

  <!-- Form -->
  @if (!isLoading()) {
  <div class="form-card">
    <!-- Header -->
    <div class="form-header">
      <div class="header-content">
        <svg class="header-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
        </svg>
        <div>
          <h1 class="form-title">
            {{ isEditMode() ? 'Edit Company' : 'Add New Company' }}
          </h1>
          <p class="form-subtitle">
            {{
            isEditMode()
            ? 'Update company information'
            : 'Create a new company in your database'
            }}
          </p>
        </div>
      </div>
    </div>

    <!-- Error Alert -->
    @if (error()) {
    <div class="error-alert">
      <svg class="error-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span>{{ error() }}</span>
    </div>
    }

    <!-- Form -->
    <form [formGroup]="companyForm" (ngSubmit)="onSubmit()" class="form-content">
      <!-- Company Information Section -->
      <div class="form-section">
        <h2 class="section-title">
          <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          Company Information
        </h2>

        <!-- Company Name -->
        <div class="form-group">
          <label for="name" class="form-label">
            Company Name <span class="required">*</span>
          </label>
          <input type="text" id="name" formControlName="name" class="form-input"
            [class.input-error]="name?.invalid && name?.touched" placeholder="e.g., Google, Microsoft, Apple" />
          @if (name?.invalid && name?.touched) {
          <p class="error-message">
            @if (name?.errors?.['required']) {
            Company name is required
            }
            @if (name?.errors?.['minlength']) {
            Company name must be at least 2 characters
            }
          </p>
          }
        </div>

        <!-- Website -->
        <div class="form-group">
          <label for="website" class="form-label"> Website </label>
          <div class="input-with-icon">
            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
            </svg>
            <input type="url" id="website" formControlName="website" class="form-input with-icon"
              placeholder="https://www.example.com" />
          </div>
        </div>

        <!-- Address -->
        <div class="form-group">
          <label for="address" class="form-label"> Address </label>
          <div class="input-with-icon">
            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <input type="text" id="address" formControlName="address" class="form-input with-icon"
              placeholder="1234 Main Street, City, Country" />
          </div>
        </div>

        <!-- Industry -->
        <div class="form-group">
          <label for="industry" class="form-label"> Industry </label>
          <select id="industry" formControlName="industry" class="form-input form-select">
            <option value="">Select an industry...</option>
            @for (industry of industryOptions; track industry) {
            <option [value]="industry">{{ industry }}</option>
            }
          </select>
        </div>

        <!-- Tech Stack -->
        <div class="form-group">
          <label class="form-label"> Tech Stack </label>
          <div class="tech-stack-input">
            <div class="tech-tags-container">
              @for (tech of techStack(); track tech; let i = $index) {
              <span class="tech-tag-input">
                {{ tech }}
                <button type="button" class="tech-remove" (click)="removeTech(i)">Ã—</button>
              </span>
              }
            </div>
            <div class="input-with-button">
              <input type="text" class="form-input" placeholder="Type a technology and press Enter..."
                [value]="newTech()" (input)="newTech.set($any($event.target).value)"
                (keydown)="onTechKeydown($event)" />
              <button type="button" class="btn-add-tech" (click)="addTech()">Add</button>
            </div>
          </div>
        </div>
      </div>

      <!-- HR Contact Section -->
      <div class="form-section">
        <h2 class="section-title">
          <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
          HR Contact Information
          <span class="optional-badge">Optional</span>
        </h2>

        <!-- HR Contact Name -->
        <div class="form-group">
          <label for="hrContactName" class="form-label"> HR Contact Name </label>
          <div class="input-with-icon">
            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
            <input type="text" id="hrContactName" formControlName="hrContactName" class="form-input with-icon"
              placeholder="John Doe" />
          </div>
        </div>

        <!-- HR Contact Email -->
        <div class="form-group">
          <label for="hrContactEmail" class="form-label"> HR Contact Email </label>
          <div class="input-with-icon">
            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            <input type="email" id="hrContactEmail" formControlName="hrContactEmail" class="form-input with-icon"
              [class.input-error]="hrContactEmail?.invalid && hrContactEmail?.touched" placeholder="hr@example.com" />
          </div>
          @if (hrContactEmail?.invalid && hrContactEmail?.touched) {
          <p class="error-message">Please enter a valid email address</p>
          }
        </div>

        <!-- HR LinkedIn -->
        <div class="form-group">
          <label for="hrContactLinkedIn" class="form-label"> HR LinkedIn Profile </label>
          <div class="input-with-icon">
            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            <input type="url" id="hrContactLinkedIn" formControlName="hrContactLinkedIn" class="form-input with-icon"
              placeholder="https://www.linkedin.com/in/johndoe" />
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="button" (click)="goBack()" class="btn btn-secondary">
          <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          Cancel
        </button>

        <button type="submit" class="btn btn-primary" [disabled]="isSubmitting() || companyForm.invalid">
          @if (isSubmitting()) {
          <div class="btn-spinner"></div>
          <span>Saving...</span>
          } @else {
          <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          <span>{{ isEditMode() ? 'Update Company' : 'Create Company' }}</span>
          }
        </button>
      </div>
    </form>
  </div>
  }
</div>