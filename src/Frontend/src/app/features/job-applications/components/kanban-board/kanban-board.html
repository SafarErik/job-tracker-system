<!-- Open Air Kanban Board - Premium Design with Horizontal Scroll -->
<div class="h-[calc(100vh-140px)] w-full overflow-x-auto overflow-y-hidden pb-4">

  <!-- The Board: Flex Row with Gap -->
  <div class="flex h-full gap-6 px-1" cdkDropListGroup>

    <!-- COLUMN LOOP -->
    @for (column of columns; track column.id) {

    <!-- 
         COLUMN: 
         - w-80 (320px) Fixed Width. 
         - shrink-0 (Never shrink below 320px).
         - Subtle background for visual grouping
      -->
    <div class="flex h-full w-80 flex-col shrink-0 gap-4 rounded-2xl bg-muted/40 p-2 border-t-2" [class]="column.color">

      <!-- Header - Large confident text -->
      <div class="flex items-center justify-between px-2 pt-2">
        <h3 class="font-bold text-base tracking-tight flex items-center gap-2 uppercase opacity-90"
          [class]="getColumnColorClass(column.status)">
          {{ column.title }}
          <span
            class="flex h-6 w-6 items-center justify-center rounded-full bg-muted text-xs font-medium text-muted-foreground">
            {{ column.applications.length }}
          </span>
        </h3>
      </div>

      <!-- Drop List (Vertical Scroll for cards) -->
      <div cdkDropList [id]="column.id" [cdkDropListData]="column.applications"
        [cdkDropListConnectedTo]="getConnectedLists()" (cdkDropListDropped)="onCardDropped($event)"
        class="flex flex-1 flex-col gap-3 overflow-y-auto px-1 pb-2 custom-scrollbar">
        @for (app of column.applications; track app.id) {
        <div cdkDrag [cdkDragData]="app" class="group">

          <!-- DRAG PLACEHOLDER (The ghost spot) -->
          <div *cdkDragPlaceholder class="mb-3 h-24 rounded-2xl border-2 border-dashed border-primary/20 bg-primary/5">
          </div>

          <!-- THE CARD: Compact mode for Kanban -->
          <app-job-card [application]="app" [compact]="true" (openWorkstation)="onOpenWorkstation($event)"
            (openJobUrl)="onOpenJobUrl($event)"></app-job-card>

        </div>
        }

        <!-- Empty State -->
        @if (column.applications.length === 0) {
        <div class="flex flex-col items-center justify-center py-12 text-muted-foreground/50">
          <svg class="w-10 h-10 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
              d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
          </svg>
          <p class="text-sm">Drop here</p>
        </div>
        }
      </div>
    </div>
    }

  </div>
</div>