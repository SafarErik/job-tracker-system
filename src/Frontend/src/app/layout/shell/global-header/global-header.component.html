<div class="grid grid-cols-3 items-center w-full">
  <!-- Left Side: Breadcrumbs -->
  <div class="flex items-center">
    <nav hlmBreadcrumb>
      <ol hlmBreadcrumbList>
        <li hlmBreadcrumbItem>
          <a hlmBreadcrumbLink [link]="'/'">Home</a>
        </li>
        @for (breadcrumb of breadcrumbService.breadcrumbs(); track breadcrumb.url; let last = $last) {
        <li hlmBreadcrumbSeparator></li>
        <li hlmBreadcrumbItem>
          @if (last) {
          <span hlmBreadcrumbPage>{{ breadcrumb.label }}</span>
          } @else {
          <a hlmBreadcrumbLink [link]="breadcrumb.url">{{ breadcrumb.label }}</a>
          }
        </li>
        }
      </ol>
    </nav>
  </div>

  <!-- Center: Command Palette Trigger -->
  <div class="flex justify-center">
    <button (click)="isOpen.set(true)" hlmBtn variant="outline"
      class="relative h-9 w-64 justify-start rounded-xl bg-muted/50 border-border text-sm font-normal text-muted-foreground shadow-none hover:bg-muted hover:text-foreground transition-all overflow-hidden group">
      <div
        class="absolute inset-0 bg-linear-to-r from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
      </div>
      <ng-icon hlm name="lucideSearch" class="mr-2 h-4 w-4" />
      <span class="inline-flex relative z-10">Ask AI or search...</span>
      <kbd
        class="pointer-events-none absolute right-[0.3rem] top-[0.3rem] hidden h-6 select-none items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex text-muted-foreground">
        <span class="text-xs">⌘</span>K
      </kbd>
    </button>
  </div>

  <!-- Right Side: Actions -->
  <div class="flex items-center justify-end gap-1">
    <button hlmBtn variant="ghost" size="icon" (click)="uiService.openAddAppSheet()" class="h-9 w-9">
      <ng-icon hlm name="lucidePlus" class="h-5 w-5" />
    </button>

    <app-notification-center />

    <app-theme-toggle />
  </div>

  <!-- Command Palette Dialog -->
  <hlm-dialog [state]="isOpen() ? 'open' : 'closed'" (closed)="isOpen.set(false)">
    <ng-template brnDialogContent>
      <hlm-dialog-content hlmCommandDialog
        class="max-w-[90vw] md:max-w-2xl bg-popover/95 backdrop-blur-xl border border-border p-0 overflow-hidden shadow-2xl dark:shadow-primary/5">
        <hlm-command hlmClassName="bg-transparent border-none">
          <input hlmCommandSearchInput placeholder="Type a command or search..." class="h-12 border-b border-border" />
          <hlm-command-list hlmClassName="max-h-[300px] overflow-y-auto scrollbar-hide py-2 px-2">
            <div *hlmCommandEmptyState hlmCommandEmpty class="py-6 text-center text-sm text-muted-foreground">
              No results found.
            </div>

            <hlm-command-group label="Suggestions">
              <button hlmCommandItem value="calendar">
                <ng-icon hlm name="lucideCalendar" hlmCommandIcon />
                <span>Calendar</span>
              </button>
              <button hlmCommandItem value="emoji">
                <ng-icon hlm name="lucideSmile" hlmCommandIcon />
                <span>Search Emoji</span>
              </button>
              <button hlmCommandItem value="calculator">
                <ng-icon hlm name="lucideCalculator" hlmCommandIcon />
                <span>Calculator</span>
              </button>
            </hlm-command-group>

            <hlm-command-separator />

            <hlm-command-group label="Settings">
              <button hlmCommandItem value="profile">
                <ng-icon hlm name="lucideUser" hlmCommandIcon />
                <span>Profile</span>
                <hlm-command-shortcut>⌘P</hlm-command-shortcut>
              </button>
              <button hlmCommandItem value="mail">
                <ng-icon hlm name="lucideMail" hlmCommandIcon />
                <span>Mail</span>
                <hlm-command-shortcut>⌘B</hlm-command-shortcut>
              </button>
              <button hlmCommandItem value="settings">
                <ng-icon hlm name="lucideSettings" hlmCommandIcon />
                <span>Settings</span>
                <hlm-command-shortcut>⌘S</hlm-command-shortcut>
              </button>
            </hlm-command-group>
          </hlm-command-list>
        </hlm-command>
      </hlm-dialog-content>
    </ng-template>
  </hlm-dialog>
</div>